---
title: "Mostrar columnas como una fila separada por comas en Crystal Reports"
layout: post
date: "2014-03-06 19:30:00"
updated: "2014-03-06 19:56:53"
tags: [whileprintingrecords, variable global, Crystal Reports]
comments: true
share: true
---

<div class="css-full-post-content js-full-post-content">
<div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-ONNIymTq6k8/UxMfiA0IJfI/AAAAAAAAt5I/g7pIhUjeMRo/s1600/descarga.jpeg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-ONNIymTq6k8/UxMfiA0IJfI/AAAAAAAAt5I/g7pIhUjeMRo/s1600/descarga.jpeg" height="61" width="320" /></a></div><br />Usamos actualmente Crystal Reports para mostrar facturas, presupuestos, balances y demás información. Uno de los últimos requerimientos era mostrar la información en una sola línea separada por comas en lugar de una columna. Antes:<br /><blockquote class="tr_bq">CONCEPTO &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PRECIO<br />concepto1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3% &nbsp; &nbsp; &nbsp; &nbsp;24€<br />concepto1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;5% &nbsp; &nbsp; &nbsp; &nbsp;10€<br />concepto1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2% &nbsp; &nbsp; &nbsp; &nbsp;40€<br />concepto2 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4% &nbsp; &nbsp; &nbsp; &nbsp;15€<br />concepto2 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;5% &nbsp; &nbsp; &nbsp; &nbsp;10€</blockquote>Después:<br /><blockquote class="tr_bq">CONCEPTO&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PRECIO<br />concepto1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3% 24€, 5% 10€, 2% 40€<br />concepto2 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4% 15€, 5% 10€</blockquote>Para poder realizar esto hay dos puntos claves, la instrucción "WhilePrintingRecords" y una variable global, una variable que pueda ser accedida desde fórmulas diferentes.<br /><br />Pasamos a comentar paso por paso. Lo primero es crear una fórmula en el Detalle, el cual suprimiremos (ocultaremos). Fijaos que esta en sintaxis VisualBasic<br /><blockquote class="tr_bq">WhilePrintingRecords<br /><br />global precioList as string<br /><br />if len(precioList&nbsp;) = 0 then<br />&nbsp; &nbsp; &nbsp;precioList&nbsp;= {db.porcentajeVariable} + " &nbsp;"&nbsp;+&nbsp;{db.precioVariable}<br />else<br />&nbsp; &nbsp; &nbsp;precioList&nbsp;=&nbsp;precioList&nbsp;+ ", " + {db.porcentajeVariable}&nbsp;+ " &nbsp;"&nbsp;+<br />&nbsp;{db.nombreVariable}<br />end if<br /><br />formula = ""</blockquote>El segundo paso es crear otra formula en el pie de grupo donde mostraremos el acumulado y lo reiniciaremos:<br /><br /><blockquote class="tr_bq">WhilePrintingRecords<br />global nameList as string<br />formula = nameList<br />nameList = ""</blockquote>Espero que os sirva!<br /><br />Fuente <a href="http://scn.sap.com/thread/1620836" target="_blank">Foro SAP Community Network</a>
</div>